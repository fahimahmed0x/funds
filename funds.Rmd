---
title: "ETFs"
author: "Fahim Ahmed"
date: "6/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r, include = FALSE}
x <- read_csv("ETFs.csv", col_types = cols(
  fund_symbol = col_character(),
  fund_extended_name = col_character(),
  fund_family = col_character(),
  inception_date = col_date(format = ""),
  category = col_character(),
  investment_strategy = col_character(),
  investment_type = col_character(),
  size_type = col_character(),
  currency = col_character(),
  fund_net_annual_expense_ratio = col_double(),
  category_net_annual_expense_ratio = col_double(),
  asset_stocks = col_double(),
  asset_bonds = col_double(),
  price_earnings_ratio = col_double(),
  price_book_ratio = col_double(),
  price_sales_ratio = col_double(),
  price_cashflow_ratio = col_double(),
  sector_basic_materials = col_double(),
  sector_consumer_cyclical = col_double(),
  sector_financial_services = col_double(),
  sector_real_estate = col_double(),
  sector_consumer_defensive = col_double(),
  sector_healthcare = col_double(),
  sector_utilities = col_double(),
  sector_communication_services = col_double(),
  sector_energy = col_double(),
  sector_industrials = col_double(),
  sector_technology = col_double(),
  credit_us_government = col_double(),
  credit_aaa = col_double(),
  credit_aa = col_double(),
  credit_a = col_double(),
  credit_bbb = col_double(),
  credit_bb = col_double(),
  credit_b = col_double(),
  credit_below_b = col_double(),
  credit_other_ratings = col_double(),
  net_asset_value = col_double(),
  fund_yield = col_double(),
  top10_holdings = col_character(),
  fund_return_ytd = col_double(),
  category_return_ytd = col_double(),
  fund_return_1month = col_double(),
  category_return_1month = col_double(),
  fund_return_3months = col_double(),
  category_return_3months = col_double(),
  fund_return_1year = col_double(),
  category_return_1year = col_double(),
  fund_return_3years = col_double(),
  category_return_3years = col_double(),
  fund_return_5years = col_double(),
  category_return_5years = col_double(),
  fund_return_10years = col_double(),
  category_return_10years = col_double(),
  fund_return_2019 = col_double(),
  category_return_2019 = col_logical(),
  fund_return_2018 = col_double(),
  category_return_2018 = col_logical(),
  fund_return_2017 = col_double(),
  category_return_2017 = col_logical(),
  fund_return_2016 = col_double(),
  category_return_2016 = col_logical(),
  fund_return_2015 = col_double(),
  category_return_2015 = col_double(),
  fund_return_2014 = col_double(),
  category_return_2014 = col_double(),
  fund_return_2013 = col_double(),
  category_return_2013 = col_double(),
  fund_return_2012 = col_double(),
  category_return_2012 = col_double(),
  fund_return_2011 = col_double(),
  category_return_2011 = col_double(),
  fund_return_2010 = col_double(),
  category_return_2010 = col_double(),
  years_up = col_double(),
  years_down = col_double(),
  fund_alpha_3years = col_double(),
  category_alpha_3years = col_double(),
  fund_alpha_5years = col_double(),
  category_alpha_5years = col_double(),
  fund_alpha_10years = col_double(),
  category_alpha_10years = col_double(),
  fund_beta_3years = col_double(),
  category_beta_3years = col_double(),
  fund_beta_5years = col_double(),
  category_beta_5years = col_double(),
  fund_beta_10years = col_double(),
  category_beta_10years = col_double(),
  fund_mean_annual_return_3years = col_double(),
  category_mean_annual_return_3years = col_double(),
  fund_mean_annual_return_5years = col_double(),
  category_mean_annual_return_5years = col_double(),
  fund_mean_annual_return_10years = col_double(),
  category_mean_annual_return_10years = col_double(),
  fund_r_squared_3years = col_double(),
  category_r_squared_3years = col_double(),
  fund_r_squared_5years = col_double(),
  category_r_squared_5years = col_double(),
  fund_r_squared_10years = col_double(),
  category_r_squared_10years = col_double(),
  fund_standard_deviation_3years = col_double(),
  category_standard_deviation_3years = col_double(),
  fund_standard_deviation_5years = col_double(),
  category_standard_deviation_5years = col_double(),
  fund_standard_deviation_10years = col_double(),
  category_standard_deviation_10years = col_double(),
  fund_sharpe_ratio_3years = col_double(),
  category_sharpe_ratio_3years = col_double(),
  fund_sharpe_ratio_5years = col_double(),
  category_sharpe_ratio_5years = col_double(),
  fund_sharpe_ratio_10years = col_double(),
  category_sharpe_ratio_10years = col_double(),
  fund_treynor_ratio_3years = col_double(),
  category_treynor_ratio_3years = col_double(),
  fund_treynor_ratio_5years = col_double(),
  category_treynor_ratio_5years = col_double(),
  fund_treynor_ratio_10years = col_double(),
  category_treynor_ratio_10years = col_double()
))
```

```{r, echo = FALSE}
x %>% 
  select(fund_symbol, fund_family, fund_return_1year) %>%
  group_by(fund_family) %>%
  summarize(avg_return = mean(fund_return_1year)) %>%
  arrange(desc(avg_return)) %>%
  head(5) %>%
  mutate(fund_family = fct_infreq(fund_family)) %>%
  mutate(fund_family = fct_rev(fund_family)) %>%
  ggplot(mapping = aes(x = fct_reorder(fund_family, avg_return), y = avg_return)) +
    geom_col(fill = "LightBlue") +
    theme_classic() +
    labs(title = "Top 5 ETF Managers",
       subtitle = "ARK ETF Trust was the best performing ETF fund, based on 1 year of performance",
       x = "Fund Family",
       y = "Average ETF Return (Percent)",
       caption = "Source: Yahoo Finance")
```

```{r, echo = FALSE}
# Does fund_yield correlate to higher returns? 
x %>%
  select(fund_symbol, fund_yield, fund_return_1year) %>%
  ggplot(mapping = aes(x = fund_yield, y = fund_return_1year)) +
    geom_point(alpha = 0.2) +
    xlim(c(0, 20)) +
    geom_smooth(method = "lm", formula = y~x, se = FALSE)

```

```{r, echo = FALSE}
# Graph where x = sector_basic_materials, and y = fund_return_1year. do the same for each sector.
```

